[build]
builder = "nixpacks"
watchPatterns = ["**/*.py", "requirements.txt"]

[deploy]
startCommand = "gunicorn --chdir backend app:app --bind 0.0.0.0:$PORT"
healthcheckPath = "/health"
healthcheckTimeout = 300
restartPolicyType = "on_failure"

[nixpacks]
enable-system-linker = true

# Configure Python version and system packages
[variables]
NIXPACKS_PYTHON_VERSION = "3.9"
NIXPACKS_APT_PKGS = "tesseract-ocr python3-distutils"

[[services]]
name = "analyzer-backend"
internal_port = 5050
protocol = "http"

[[services.ports]]
port = 80
handlers = ["http"] 